<% content_for :title, 'Monthly overview' %>

<% if @entries.any? %>
  <table class="monthly_report">
    <tr>
      <th class="invisible">&nbsp;</th>
      <% for date in @start..@end %>
      <th class="<%= 'weekend' if [0,6].include?(date.wday) %>">
        <%= date.day %>
      </th>
      <% end %>
    </tr>
    <tr>
      <td class="invisible">&nbsp;</td>
      <% for date in @start..@end %>
      <td class="<%= 'weekend' if [0,6].include?(date.wday) %>">
        <%= @times[date.day.to_s.to_sym] %>
      </td>
      <% end %>
    </tr>
    <% @times_by_project.each do |project_name, time| %>
      <tr>
        <td class="project_name">
          <%= project_name %>
        </td>
        <% for date in @start..@end %>
          <% percent = (time[date.day.to_s.to_sym]/8).round(2) %>
          <td class="<%= 'weekend' if [0,6].include?(date.wday) %> <%= css_class_for_empty_cell(percent) %>">
            <%= percent unless percent == 0 %>
          </td>
        <% end %>
      </tr>
    <% end %>
    <tr>
      <td class="invisible">&nbsp;</td>
      <% for date in @start..@end %>
        <% percent = (@times[date.day.to_s.to_sym]/8).round(2) %>
        <td class="<%= 'weekend' if [0,6].include?(date.wday) %>">
          <span class="<%= css_class_for_percent(percent, date) %>">
            <%= percent %>
          </span>
        </td>
      <% end %>
    </tr>
  </table>
  <div>
    <div>Work days: <%= @workdays %></div>
    <div>Hours required: <%= @workdays*8 %></div>
    <div>Total hours: <%= @times_sum.round 2 %></div>
    <div>Status: <%= (@times_sum - (@workdays*8)).round 2 %></div>
    <div>Percent completed: <%= number_to_percentage(
      (@times_sum / (@workdays*8) * 100), :precision => 2) %></div>
  </div>
<% end %>
